# Based on
# https://github.com/jupyterhub/mybinder.org-deploy/blob/d53420cdbc94d2148018594d33cd35810bbffbf1/mybinder/values.yaml#L164

ingress:
  enabled: true
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/rewrite-target: /
#    nginx.ingress.kubernetes.io/add-base-url: "true"
  path: /grafana
  hosts:
  - idr-training.openmicroscopy.org
  tls:
  - hosts:
    - idr-training.openmicroscopy.org

persistence:
  enabled: false

# https://github.com/kubernetes/charts/blob/master/stable/grafana/templates/configmap.yaml
# http://docs.grafana.org/installation/configuration/
# grafana:
#   ini:
env:
  GF_AUTH_ANONYMOUS_ENABLED: "true"
  GF_SERVER_DOMAIN: idr-training.openmicroscopy.org
  GF_SERVER_ROOT_URL: "%(protocol)s://%(domain)s:/grafana"

datasources:
  datasources.yaml:
    apiVersion: 1
    datasources:
    - name: Prometheus
      type: prometheus
      url: http://prometheus-server
      access: proxy
      isDefault: true

dashboardProviders:
  dashboardproviders.yaml:
    apiVersion: 1
    providers:
    - name: 'default'
      orgId: 1
      folder: ''
      type: file
      disableDeletion: false
      editable: true
      options:
        path: /var/lib/grafana/dashboards

dashboards:
  # Install https://grafana.com/dashboards/5849
  idr-jupyter-servers:
    gnetId: 5849
    revision: 1
    datasource: Prometheus
